{"ast":null,"code":"import { SESSION_TIME_OUT_DELAY, ValueHistory } from '@datadog/browser-core';\nexport var VIEW_CONTEXT_TIME_OUT_DELAY = SESSION_TIME_OUT_DELAY;\nexport function startViewContexts(lifeCycle) {\n  var viewContextHistory = new ValueHistory(VIEW_CONTEXT_TIME_OUT_DELAY);\n  lifeCycle.subscribe(2 /* LifeCycleEventType.BEFORE_VIEW_CREATED */, function (view) {\n    viewContextHistory.add(buildViewContext(view), view.startClocks.relative);\n  });\n  lifeCycle.subscribe(6 /* LifeCycleEventType.AFTER_VIEW_ENDED */, function (_a) {\n    var endClocks = _a.endClocks;\n    viewContextHistory.closeActive(endClocks.relative);\n  });\n  lifeCycle.subscribe(10 /* LifeCycleEventType.SESSION_RENEWED */, function () {\n    viewContextHistory.reset();\n  });\n  function buildViewContext(view) {\n    return {\n      service: view.service,\n      version: view.version,\n      id: view.id,\n      name: view.name,\n      startClocks: view.startClocks\n    };\n  }\n  return {\n    findView: function (startTime) {\n      return viewContextHistory.find(startTime);\n    },\n    stop: function () {\n      viewContextHistory.stop();\n    }\n  };\n}","map":{"version":3,"names":["SESSION_TIME_OUT_DELAY","ValueHistory","VIEW_CONTEXT_TIME_OUT_DELAY","startViewContexts","lifeCycle","viewContextHistory","subscribe","view","add","buildViewContext","startClocks","relative","_a","endClocks","closeActive","reset","service","version","id","name","findView","startTime","find","stop"],"sources":["D:\\edu'\\Spritle\\Spritle\\node_modules\\@datadog\\browser-rum-core\\src\\domain\\contexts\\viewContexts.ts"],"sourcesContent":["import type { RelativeTime, ClocksState } from '@datadog/browser-core'\nimport { SESSION_TIME_OUT_DELAY, ValueHistory } from '@datadog/browser-core'\nimport type { LifeCycle } from '../lifeCycle'\nimport { LifeCycleEventType } from '../lifeCycle'\nimport type { ViewCreatedEvent } from '../view/trackViews'\n\nexport const VIEW_CONTEXT_TIME_OUT_DELAY = SESSION_TIME_OUT_DELAY\n\nexport interface ViewContext {\n  service?: string\n  version?: string\n  id: string\n  name?: string\n  startClocks: ClocksState\n}\n\nexport interface ViewContexts {\n  findView: (startTime?: RelativeTime) => ViewContext | undefined\n  stop: () => void\n}\n\nexport function startViewContexts(lifeCycle: LifeCycle): ViewContexts {\n  const viewContextHistory = new ValueHistory<ViewContext>(VIEW_CONTEXT_TIME_OUT_DELAY)\n\n  lifeCycle.subscribe(LifeCycleEventType.BEFORE_VIEW_CREATED, (view) => {\n    viewContextHistory.add(buildViewContext(view), view.startClocks.relative)\n  })\n\n  lifeCycle.subscribe(LifeCycleEventType.AFTER_VIEW_ENDED, ({ endClocks }) => {\n    viewContextHistory.closeActive(endClocks.relative)\n  })\n\n  lifeCycle.subscribe(LifeCycleEventType.SESSION_RENEWED, () => {\n    viewContextHistory.reset()\n  })\n\n  function buildViewContext(view: ViewCreatedEvent) {\n    return {\n      service: view.service,\n      version: view.version,\n      id: view.id,\n      name: view.name,\n      startClocks: view.startClocks,\n    }\n  }\n\n  return {\n    findView: (startTime) => viewContextHistory.find(startTime),\n    stop: () => {\n      viewContextHistory.stop()\n    },\n  }\n}\n"],"mappings":"AACA,SAASA,sBAAsB,EAAEC,YAAY,QAAQ,uBAAuB;AAK5E,OAAO,IAAMC,2BAA2B,GAAGF,sBAAsB;AAejE,OAAM,SAAUG,iBAAiBA,CAACC,SAAoB;EACpD,IAAMC,kBAAkB,GAAG,IAAIJ,YAAY,CAAcC,2BAA2B,CAAC;EAErFE,SAAS,CAACE,SAAS,iDAAyC,UAACC,IAAI;IAC/DF,kBAAkB,CAACG,GAAG,CAACC,gBAAgB,CAACF,IAAI,CAAC,EAAEA,IAAI,CAACG,WAAW,CAACC,QAAQ,CAAC;EAC3E,CAAC,CAAC;EAEFP,SAAS,CAACE,SAAS,8CAAsC,UAACM,EAAa;QAAXC,SAAS,GAAAD,EAAA,CAAAC,SAAA;IACnER,kBAAkB,CAACS,WAAW,CAACD,SAAS,CAACF,QAAQ,CAAC;EACpD,CAAC,CAAC;EAEFP,SAAS,CAACE,SAAS,8CAAqC;IACtDD,kBAAkB,CAACU,KAAK,EAAE;EAC5B,CAAC,CAAC;EAEF,SAASN,gBAAgBA,CAACF,IAAsB;IAC9C,OAAO;MACLS,OAAO,EAAET,IAAI,CAACS,OAAO;MACrBC,OAAO,EAAEV,IAAI,CAACU,OAAO;MACrBC,EAAE,EAAEX,IAAI,CAACW,EAAE;MACXC,IAAI,EAAEZ,IAAI,CAACY,IAAI;MACfT,WAAW,EAAEH,IAAI,CAACG;KACnB;EACH;EAEA,OAAO;IACLU,QAAQ,EAAE,SAAAA,CAACC,SAAS;MAAK,OAAAhB,kBAAkB,CAACiB,IAAI,CAACD,SAAS,CAAC;IAAlC,CAAkC;IAC3DE,IAAI,EAAE,SAAAA,CAAA;MACJlB,kBAAkB,CAACkB,IAAI,EAAE;IAC3B;GACD;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}