{"ast":null,"code":"import { getInitCookie } from '@datadog/browser-core';\nimport { createCookieObservable } from '../../browser/cookieObservable';\nexport var CI_VISIBILITY_TEST_ID_COOKIE_NAME = 'datadog-ci-visibility-test-execution-id';\nexport function startCiVisibilityContext(configuration, cookieObservable) {\n  var _a;\n  if (cookieObservable === void 0) {\n    cookieObservable = createCookieObservable(configuration, CI_VISIBILITY_TEST_ID_COOKIE_NAME);\n  }\n  var testExecutionId = getInitCookie(CI_VISIBILITY_TEST_ID_COOKIE_NAME) || ((_a = window.Cypress) === null || _a === void 0 ? void 0 : _a.env('traceId'));\n  var cookieObservableSubscription = cookieObservable.subscribe(function (value) {\n    testExecutionId = value;\n  });\n  return {\n    get: function () {\n      if (typeof testExecutionId === 'string') {\n        return {\n          test_execution_id: testExecutionId\n        };\n      }\n    },\n    stop: function () {\n      return cookieObservableSubscription.unsubscribe();\n    }\n  };\n}","map":{"version":3,"names":["getInitCookie","createCookieObservable","CI_VISIBILITY_TEST_ID_COOKIE_NAME","startCiVisibilityContext","configuration","cookieObservable","testExecutionId","_a","window","Cypress","env","cookieObservableSubscription","subscribe","value","get","test_execution_id","stop","unsubscribe"],"sources":["D:\\edu'\\Spritle\\spritle\\node_modules\\@datadog\\browser-rum-core\\src\\domain\\contexts\\ciVisibilityContext.ts"],"sourcesContent":["import { getInitCookie, type Configuration } from '@datadog/browser-core'\n\nimport { createCookieObservable } from '../../browser/cookieObservable'\n\nexport const CI_VISIBILITY_TEST_ID_COOKIE_NAME = 'datadog-ci-visibility-test-execution-id'\n\nexport interface CiTestWindow extends Window {\n  Cypress?: {\n    env: (key: string) => string | undefined\n  }\n}\n\nexport type CiVisibilityContext = ReturnType<typeof startCiVisibilityContext>\n\nexport function startCiVisibilityContext(\n  configuration: Configuration,\n  cookieObservable = createCookieObservable(configuration, CI_VISIBILITY_TEST_ID_COOKIE_NAME)\n) {\n  let testExecutionId =\n    getInitCookie(CI_VISIBILITY_TEST_ID_COOKIE_NAME) || (window as CiTestWindow).Cypress?.env('traceId')\n\n  const cookieObservableSubscription = cookieObservable.subscribe((value) => {\n    testExecutionId = value\n  })\n\n  return {\n    get: () => {\n      if (typeof testExecutionId === 'string') {\n        return {\n          test_execution_id: testExecutionId,\n        }\n      }\n    },\n    stop: () => cookieObservableSubscription.unsubscribe(),\n  }\n}\n"],"mappings":"AAAA,SAASA,aAAa,QAA4B,uBAAuB;AAEzE,SAASC,sBAAsB,QAAQ,gCAAgC;AAEvE,OAAO,IAAMC,iCAAiC,GAAG,yCAAyC;AAU1F,OAAM,SAAUC,wBAAwBA,CACtCC,aAA4B,EAC5BC,gBAA2F;;EAA3F,IAAAA,gBAAA;IAAAA,gBAAA,GAAmBJ,sBAAsB,CAACG,aAAa,EAAEF,iCAAiC,CAAC;EAAA;EAE3F,IAAII,eAAe,GACjBN,aAAa,CAACE,iCAAiC,CAAC,KAAI,CAAAK,EAAA,GAACC,MAAuB,CAACC,OAAO,cAAAF,EAAA,uBAAAA,EAAA,CAAEG,GAAG,CAAC,SAAS,CAAC;EAEtG,IAAMC,4BAA4B,GAAGN,gBAAgB,CAACO,SAAS,CAAC,UAACC,KAAK;IACpEP,eAAe,GAAGO,KAAK;EACzB,CAAC,CAAC;EAEF,OAAO;IACLC,GAAG,EAAE,SAAAA,CAAA;MACH,IAAI,OAAOR,eAAe,KAAK,QAAQ,EAAE;QACvC,OAAO;UACLS,iBAAiB,EAAET;SACpB;MACH;IACF,CAAC;IACDU,IAAI,EAAE,SAAAA,CAAA;MAAM,OAAAL,4BAA4B,CAACM,WAAW,EAAE;IAA1C;GACb;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}