{"ast":null,"code":"import { toServerDuration, relativeToClocks, generateUUID } from '@datadog/browser-core';\nimport { RumPerformanceEntryType } from '../../browser/performanceCollection';\nexport function startLongTaskCollection(lifeCycle, configuration, sessionManager) {\n  lifeCycle.subscribe(0 /* LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED */, function (entries) {\n    for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n      var entry = entries_1[_i];\n      if (entry.entryType !== RumPerformanceEntryType.LONG_TASK) {\n        break;\n      }\n      var session = sessionManager.findTrackedSession(entry.startTime);\n      if (!session || !configuration.trackLongTasks) {\n        break;\n      }\n      var startClocks = relativeToClocks(entry.startTime);\n      var rawRumEvent = {\n        date: startClocks.timeStamp,\n        long_task: {\n          id: generateUUID(),\n          duration: toServerDuration(entry.duration)\n        },\n        type: \"long_task\" /* RumEventType.LONG_TASK */,\n        _dd: {\n          discarded: false\n        }\n      };\n      lifeCycle.notify(12 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, {\n        rawRumEvent: rawRumEvent,\n        startTime: startClocks.relative,\n        domainContext: {\n          performanceEntry: entry\n        }\n      });\n    }\n  });\n}","map":{"version":3,"names":["toServerDuration","relativeToClocks","generateUUID","RumPerformanceEntryType","startLongTaskCollection","lifeCycle","configuration","sessionManager","subscribe","entries","_i","entries_1","length","entry","entryType","LONG_TASK","session","findTrackedSession","startTime","trackLongTasks","startClocks","rawRumEvent","date","timeStamp","long_task","id","duration","type","_dd","discarded","notify","relative","domainContext","performanceEntry"],"sources":["D:\\edu'\\Spritle\\Spritle\\node_modules\\@datadog\\browser-rum-core\\src\\domain\\longTask\\longTaskCollection.ts"],"sourcesContent":["import { toServerDuration, relativeToClocks, generateUUID } from '@datadog/browser-core'\nimport type { RawRumLongTaskEvent } from '../../rawRumEvent.types'\nimport { RumEventType } from '../../rawRumEvent.types'\nimport type { LifeCycle } from '../lifeCycle'\nimport { LifeCycleEventType } from '../lifeCycle'\nimport type { RumSessionManager } from '../rumSessionManager'\nimport { RumPerformanceEntryType } from '../../browser/performanceCollection'\nimport type { RumConfiguration } from '../configuration'\n\nexport function startLongTaskCollection(\n  lifeCycle: LifeCycle,\n  configuration: RumConfiguration,\n  sessionManager: RumSessionManager\n) {\n  lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED, (entries) => {\n    for (const entry of entries) {\n      if (entry.entryType !== RumPerformanceEntryType.LONG_TASK) {\n        break\n      }\n      const session = sessionManager.findTrackedSession(entry.startTime)\n      if (!session || !configuration.trackLongTasks) {\n        break\n      }\n      const startClocks = relativeToClocks(entry.startTime)\n      const rawRumEvent: RawRumLongTaskEvent = {\n        date: startClocks.timeStamp,\n        long_task: {\n          id: generateUUID(),\n          duration: toServerDuration(entry.duration),\n        },\n        type: RumEventType.LONG_TASK,\n        _dd: {\n          discarded: false,\n        },\n      }\n      lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, {\n        rawRumEvent,\n        startTime: startClocks.relative,\n        domainContext: { performanceEntry: entry },\n      })\n    }\n  })\n}\n"],"mappings":"AAAA,SAASA,gBAAgB,EAAEC,gBAAgB,EAAEC,YAAY,QAAQ,uBAAuB;AAMxF,SAASC,uBAAuB,QAAQ,qCAAqC;AAG7E,OAAM,SAAUC,uBAAuBA,CACrCC,SAAoB,EACpBC,aAA+B,EAC/BC,cAAiC;EAEjCF,SAAS,CAACG,SAAS,2DAAmD,UAACC,OAAO;IAC5E,KAAoB,IAAAC,EAAA,IAAO,EAAPC,SAAA,GAAAF,OAAO,EAAPC,EAAA,GAAAC,SAAA,CAAAC,MAAO,EAAPF,EAAA,EAAO,EAAE;MAAxB,IAAMG,KAAK,GAAAF,SAAA,CAAAD,EAAA;MACd,IAAIG,KAAK,CAACC,SAAS,KAAKX,uBAAuB,CAACY,SAAS,EAAE;QACzD;MACF;MACA,IAAMC,OAAO,GAAGT,cAAc,CAACU,kBAAkB,CAACJ,KAAK,CAACK,SAAS,CAAC;MAClE,IAAI,CAACF,OAAO,IAAI,CAACV,aAAa,CAACa,cAAc,EAAE;QAC7C;MACF;MACA,IAAMC,WAAW,GAAGnB,gBAAgB,CAACY,KAAK,CAACK,SAAS,CAAC;MACrD,IAAMG,WAAW,GAAwB;QACvCC,IAAI,EAAEF,WAAW,CAACG,SAAS;QAC3BC,SAAS,EAAE;UACTC,EAAE,EAAEvB,YAAY,EAAE;UAClBwB,QAAQ,EAAE1B,gBAAgB,CAACa,KAAK,CAACa,QAAQ;SAC1C;QACDC,IAAI;QACJC,GAAG,EAAE;UACHC,SAAS,EAAE;;OAEd;MACDxB,SAAS,CAACyB,MAAM,sDAA6C;QAC3DT,WAAW,EAAAA,WAAA;QACXH,SAAS,EAAEE,WAAW,CAACW,QAAQ;QAC/BC,aAAa,EAAE;UAAEC,gBAAgB,EAAEpB;QAAK;OACzC,CAAC;IACJ;EACF,CAAC,CAAC;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}